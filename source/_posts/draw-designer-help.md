---
layout: post
title: 电脑抽奖程序设计器帮助文档
author: 贺斌
date: 2016-12-25 16:30:21
categories: 抽奖程序
tags:
 - 电视抽奖
 - 抽奖程序
 - 节目互动
 - 远程遥控
 - 跨平台
hidden: true
---


## 1. 快速上手

成功安装《飞翔电脑抽奖程序设计器》后，双击桌面上的快捷方式可启动抽奖设计器并直接进入抽奖程序设计主界面。如下图：

![](/images/draw-designer-help/dd_main.png)

通过『新建工程』窗口中的工程模板，只需经过简单的三个步骤（数据源设置、界面设计、工程发布）就可设计出一个抽奖方案。根据抽奖的类型（姓名号码类、照片类、随机数字类），选择一个基本符合自己需求的模板，点击『确定』按钮，自动创建一个新的抽奖工程（本例为姓名号码类）。如下图：

![](/images/draw-designer-help/dd_main2.png)

### 1.1 数据源设置

点击 <span style="background-image: url(/images/draw-designer-help/project_config.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，打开『工程设置』窗口，选择『数据源』标签，设置数据源。详见[「工程设置」](#project_config)部分。

![](/images/draw-designer-help/dd_prjcfg_ds.png)

本例为姓名号码类，所以设置『数据文件』数据源，选择一个CSV文件，程序会自动加载文件中的数据，我们可以看到该数据文件所包含的字段。

点击『确定』按钮，完成数据源的设置。

### 1.2 界面设计

现实中的一次抽奖，会包含若干奖项，每个奖项可能会抽取若干次，每次产生若干中奖人员。因此，一个抽奖工程，包含若干场景（对应于奖项），每个场景可以单独设计抽奖的界面风格；每个场景中会包含若干元素对象（包括文本和图片），文本对象显示静态的文字信息（例如一些标题文字）或数据源中的动态数据信息（人员的姓名号码或随机数字），图片对象显示静态的图片或数据源中的动态图片数据。详见「界面设计」部分。

### 1.3 工程发布

在设计器中完成抽奖程序的设计后，可以将工程发布。发布后的抽奖程序，完全脱离设计环境，可以复制任何一台计算机上运行。详见「打包发布」部分

点击 <span style="background-image: url(/images/draw-designer-help/project_publish.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，启动『发布向导』，依向导可完成抽奖工程的发布工作。

![](/images/draw-designer-help/dd_publish1.png)

发布后的工程，如下图。

![](/images/draw-designer-help/dd_publish0.png)



## 2. 工程设置<span id="project_config"> </span>

点击 <span style="background-image: url(/images/draw-designer-help/project_config.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，打开『工程设置』窗口，对工程进行设置。

### 2.1 属性

工程文件的属性信息，包括：工程标题、作者、公司名称、描述信息。这些属性信息对于工程文件的管理是有益的。

![](/images/draw-designer-help/dd_prjcfg_attri.png)

### 2.2 设置

`场景尺寸`：预制了一些常见的场景的宽度和高度。

`场景宽度、场景高度`：可以自定义场景的宽度和高度。

`数据刷新间隔`：抽奖程序运行时，随机读取的数据显示的时间间隔。单位是毫秒，即千分之一秒。

`显示状态信息`：抽奖程序运行时，显示提示信息。提示信息包括，当前奖项、抽奖次数、剩余数据等信息。

`全屏显示`：抽奖程序启动时，全屏显示。可以通过快捷键 Ctrl + Shift + F 在全屏和窗口之间切换。

`拉伸模式`：抽奖程序窗口尺寸改变时，拉伸变形显示。不勾选，表示以等比缩放显示。

`顶置显示`：抽奖程序运行时，显示在所有窗口的最高层。

![](/images/draw-designer-help/dd_prjcfg_cfg.png)

### 2.3 数据源

数据源是抽奖数据的来源，抽奖程序运行时，会随机从数据源中读取数据并显示在界面上。目前支持3类数据源：

#### 2.3.1  数据文件

目前支持CSV文件作为数据源。CSV文件是一种以逗号最为字段分隔符的文本文件。选择一个CSV文件作为数据源后，程序会自动加载文件中的数据，我们可以看到该数据文件所包含的字段。这里的字段名，在设计界面中进行文本对象的数据绑定时，会有用处的。可以使用「数据管理」功能，对数据源中的数据进行管理。

![](/images/draw-designer-help/dd_prjcfg_ds.png)

#### 2.3.2 图片文件夹

将一个包含有图片的文件夹作为数据源，程序会自动读取该文件夹中所支持的全部图片文件，包括子目录中的。目前支持的图片格式有：JPEG、BMP、PNG、GIF、TIFF。可以使用「数据管理」功能，对数据源中的数据进行管理。

![](/images/draw-designer-help/dd_prjcfg_ds2.png)

#### 2.3.2 随机数字

将一定区间内的随即数字作为数据源。

`长度`：随即数字占用的字符长度。

`开头补零`：若产生的随即数字的字符长度，小于设定的长度，在随即数字的开头用数字0补齐。

![](/images/draw-designer-help/dd_prjcfg_ds3.png)

### 2.4 控制键

控制键可以控制抽奖程序的运行状态。

`开始抽奖`：抽奖数据开始滚动显示。

`停止抽奖`：抽奖数据停止滚动。

`清屏`：将屏幕上停留的数据清除。

`重置数据`：删除以往的抽奖结果，重新从数据源中加载数据。

`退出程序`：关闭抽奖程序。

此外，通过快捷键 Ctrl + Shift + F 在全屏和窗口之间切换； Ctrl + Shift + R 显示抽奖结果。

![](/images/draw-designer-help/dd_prjcfg_ctrl.png)

### 2.5 远程遥控

使用方法参见《[如何通过平板电脑远程遥控抽奖程序？](../draw-designer-how-to-remote-control/)》一文。


## 3. 界面设计

程序主界面是进行抽奖程序的主要场所。整个程序界面分为5个部分：工具栏、场景列表、场景设计区、对象观察器、对象属性面板。

![](/images/draw-designer-help/dd_main_lyt.png)

### 3.1 工具栏

#### 3.1.1 系统工具栏

从左到右依次为：

`新建工程（Ctrl + N）`：打开『新建工程』窗口，可以从工程模板新建工程，或打开最近工程。

`打开工程（Ctrl + O）`：打开抽奖工程文件 (*.dprj)。

`保存工程（Ctrl + S）`：将抽奖工程文件保存到磁盘。

`工程另存为`：将抽奖工程文件以新的文件名保存到磁盘。

`关闭工程`：关闭当前打开的抽奖工程。

`工程设置`：设置当前打开的抽奖工程。详见「工程设置」部分。

`运行（F9）`：运行并预览抽奖程序，以验证抽奖工程设计的是否正确。正式抽奖时，建议将工程发布后运行。

`打包工程`：将抽奖工程打包输出到指定的文件夹，便于交流使用。详见「打包发布」部分。

`发布工程`：将抽奖工程发布输出到制定的文件夹，用于正式抽奖使用。详见「打包发布」部分。

`程序设置`：对抽奖程序设计器进行设置。

`帮助（F1）`：显示帮助文档。

`检查更新`：在线检查是否有新的版本。

`关于`：关于本软件的版本和版权信息。

`软件注册`：输入软件序列号，完成软件注册，成为正式版用户。详见「软件注册」部分。

#### 3.1.2 场景设计工具栏

从左到右依次为：

`添加文本对象`：在当前场景中添加一个文本对象。

`添加图片对象`：在当前场景中添加一个图片对象。

`场景缩放比例`：对场景设计区进行缩放显示。

### 3.2 场景列表

场景列表以缩略图形式，显示当前工程所包含的所有场景。可以通过右键菜单对场景进行管理，包括：添加、删除、复制、粘贴、上移、下移场景。

### 3.3 场景设计区

所见即所得的场景设计区，可以添加元素对象，并通过鼠标拖动方式对场景布局进行调整。在每个元素对象上点击右键，可以通过弹出菜单，进行设计操作。另外支持快捷键操作，支持的快捷键包括：

| 操作 | 快捷键 |
|------------|----------|
| 复制对象    | Ctrl + C |
| 粘贴对象    | Ctrl + V |
| 删除对象    | Delete |
| 移动对象位置 | 方向键：Up、Down、Left、Right |
| 场景缩放    | Ctrl + 鼠标管轮（向上：增大比例、向下：减少比例）|

### 3.4 对象观察器

以树形结构显示当前场景中的所有元素对象。在对象观察器中，选择某一节点，会自动选择场景中对应的元素对象。

### 3.5 对象属性面板

在场景设计区或对象观察器中选择某一个元素对象，属性面板中会自动显示该元素对象的属性。通过属性面板，可以更加详细的调整对象的属性。

#### 3.5.1 场景属性

`标题`：场景名，一般对应奖项的名称。

`快捷键`：抽奖程序运行时，在不同场景之间切换的快捷键。例如，特等奖对应快捷键 0，一等奖对应快捷键 1，二等奖对应快捷键 2。

`背景色`：表示不使用图片背景时，场景背景所显示的纯色，背景颜色可任意设置。

`背景`：使用图片作为场景背景。

`包装模式`：背景图片显示的方式。如下表：

| 值       | 含义     |
|----------|---------|
| Original | 原始尺寸 |
| Fit      | 合适尺寸 |
| Stretch  | 拉伸显示 |
| Tile     | 平铺显示 |

![](/images/draw-designer-help/dd_scene_property.png)

#### 3.5.2 文本属性

`名称`：文本对象的名字。通过给每个对象合理的命名，有助于设计时快速识别每个对象的用途。

`X`：对象距离场景左上角的水平距离。

`Y`：对象距离场景左上角的垂直距离。

`宽度`：对象的宽度。

`高度`：对象的高度。

`旋转角度`：对象相对于X轴的旋转角度，单位：度。

`透明度`：对象的透明度。从左往右，从完全不可见到完全可见。

![](/images/draw-designer-help/dd_text_property.png)

`内容值`：文本对象中显示的文字内容。

`字体`：文字对象的字体类型。

`大小`：文字对象的字体大小。

`样式`：文字对象的字体样式，包括：加粗、倾斜、下划线、删除线。

`垂直对齐`：文字内容在对象区域内垂直方向上的对齐方式，包括：Center - 居中；Leading - 顶头；Trailing - 顶底。

`水平对齐`：文字内容在对象区域内水平方向上的对齐方式，包括：Center - 居中；Leading - 左对齐；Trailing - 右对齐。

`填充类型`：文字的颜色填充类型，包括：Solid - 纯色；Gradient - 渐变色。选择不同的填充类型，会显示不同的颜色面板。其中，渐变色又包括：Linear - 线性渐变；Radial - 径向渐变。通过设置渐变角度，可以改变渐变的走向。在渐变条上点击某个位置的颜色，可以增加渐变点。

`拉伸模式`：文字会在整个对象区域内拉伸显示。

`数据字段`：文字对象对应的数据源中的字段。只有设置了数据文件数据源或随机数字数据源，才能设置该属性值。

`文字遮罩`：开启后，在抽奖程序运行时，会以遮罩字符替换原始数据，以保护抽奖对象的隐私。

`开始位置`：遮罩字符串显示的起始位置，从1开始。

`字符个数`：遮罩字符串替换原始数据的个数。

`遮罩串`：遮罩原始数据的字符串。例如：原始数据为：13912344321，开始位置：4，字符个数4，遮罩串：恭喜发财，运行时显示的为：139恭喜发财4321。

#### 3.5.3 图片属性

名称、X、Y、宽度、高度、选择角度、透明度的含义和文字对象一样，请参看「文本属性」部分。

![](/images/draw-designer-help/dd_image_property.png)

`数据类型`：图片对象中显示图片数据来源，包括：ImageFile - 图片文件；ImageFolder - 图片文件夹数据源。只有设置了图片文件夹数据源，才能设置为 ImageFolder 值。

`图片来源`：图片对象中显示的图片文件。当数据类型设置为 ImageFile 时，该属性才能进行设置。

`包装模式`：图片显示的方式。详见「场景属性」的「包装模式」部分。

`绑定文本`：当数据类型设置为 ImageFolder 时，可以为图片对象绑定文本对象，该文本对象用于显示图片的主文件名。在实际抽奖中，图片的文件名如果是对应的人员姓名，就可以通过绑定文本对象的方式，显示出图片对应的人员姓名。

`文本位置`：绑定的文本对象，相对于图片对象的位置，包括：None - 场景中的任意位置；Top - 图片对象的顶部；Bottom - 图片对象的底部；Left - 图片对象的左步；Right - 图片对象的右部。

`文本对齐`：绑定的文本对象，相对于图片对象的位置，包括：Center - 中央；Leading - 头端；Trailing - 尾端。

文本位置和文本对齐需要组合使用。组合情况如下：

| 文本位置 | 文本对齐  | 含义    |
|---------|----------|---------|
| Top     | Center   | 顶部中央 |
| Top     | Leading  | 顶部左端 |
| Top     | Training | 顶部右端 |
| Bottom  | Center   | 底部中央 |
| Bottom  | Leading  | 底部左端 |
| Bottom  | Training | 底部右端 |
| Left    | Center   | 左边中央 |
| Left    | Leading  | 左边顶部 |
| Left    | Training | 左边底部 |
| Right   | Center   | 右边中央 |
| Right   | Leading  | 右边顶部 |
| Right   | Training | 右边底部 |


## 4. 打包发布

工程打包和工程发布是将当前编辑的工程进行输出的两种方式。

### 4.1 工程打包

工程打包是将当前正在编辑的工程所用到的各类资源，整体输出到某个文件夹的过程。可以将打包后的工程复制到别的计算机中继续编辑。

点击 <span style="background-image: url(/images/draw-designer-help/project_pack.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，启动『工程打包向导』，如下图：

![](/images/draw-designer-help/dd_pack1.png)

选择一个打包输出文件夹后，点击『下一步』按钮。

![](/images/draw-designer-help/dd_pack2.png)

设置打包输出的工程文件，将要继续使用的操作系统平台，目前支持 Windows 和 Mac OS X 两种平台。依次点击『下一步』按钮继续。

![](/images/draw-designer-help/dd_pack4.png)

打包完成后，点击『完成』按钮结束向导。打包后得到的文件如下图。

![](/images/draw-designer-help/dd_pack0.png)

### 4.2 工程发布

工程发布是将当前正在编辑的工程所用到的各类资源和抽奖程序，整体输出到某个文件夹的过程。发布后得到的抽奖程序可以脱离设计器独立运行。

点击 <span style="background-image: url(/images/draw-designer-help/project_publish.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，启动『工程发布向导』，如下图：

![](/images/draw-designer-help/dd_publish1.png)

选择一个发布输出文件夹后，点击『下一步』按钮。

![](/images/draw-designer-help/dd_publish2.png)

设置发布输出的工程授权信息。可以通过设置过期日期，使发布的抽奖程序只能在过期日期之前使用。依次点击『下一步』按钮继续。

![](/images/draw-designer-help/dd_publish4.png)

发布完成后，点击『完成』按钮结束向导。发布后得到文件如下图。

![](/images/draw-designer-help/dd_publish0.png)



## 5. 程序设置

点击 <span style="background-image: url(/images/draw-designer-help/options.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，打开『程序设置』窗口，对设计器进行设置。如下图：

![](/images/draw-designer-help/dd_options.png)

`语言`：程序界面显示的语言种类。目前支持简体中文和英文。

`保存最近打开工程的个数`：程序自动记录最近打开过的工程个数。

`设计模式运行时，保存抽奖结果`：勾选后，通过工具栏 project_run 按钮调试运行抽奖程序时，保存抽奖结果。

`当设计模式运行工程时，不显示提醒信息`：勾选后，通过工具栏 project_run 按钮调试运行抽奖程序时，会显示控制提醒信息。


## 6. 开始抽奖

运行发布的抽奖程序

![](/images/draw-designer-help/dd_publish0.png)

或点击设计器的 <span style="background-image: url(/images/draw-designer-help/project_run.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，启动抽奖程序。如下图。

![](/images/draw-designer-help/dp_main1.png)

通过在界面设计时，设置的场景快捷键，可以在不同的奖项之前互相切换。详见「界面设计」的「场景属性」部分。

通过在工程设置中，设置的控制键，可以控制抽奖程序的启动和停止。详见「工程设置」的「控制键」部分。


## 7. 数据管理

设置完数据源后，点击 <span style="background-image: url(/images/draw-designer-help/project_data_manager.png); background-size: cover; width: 16px; height: 16px; display: inline-block;"></span> 按钮，打开『数据管理』窗口，对数据源数据进行管理。目前支持对「数据文件」和「图片文件夹」的数据管理。仅增强版支持该功能。

### 7.1 「数据文件」数据管理

`添加`：添加一行数据。

`删除`：删除勾选的数据行。

`保存`：保存修改后的数据文件。

点击单元格可以直接修改其内容。

![](/images/draw-designer-help/dd_data_manager1.png)

### 7.2 「图片文件夹」数据管理

`添加`：添加图片到数据源。

`删除`：删除勾选的图片文件。

`重命名`：修改图片文件的名字。双击某行数据，也可以重名。

`压缩`：对数据源中的图片文件进行压缩，提高显示效率。设置最大宽度、最大高度后，程序会按比例将图片压缩到范围之内。

![](/images/draw-designer-help/dd_data_manager2.png)
